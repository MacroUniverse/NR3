# use g++ with MKL
# reference: MKL link advisor https://software.intel.com/en-us/articles/intel-mkl-link-line-advisor

no_warn = -Wno-reorder # supress warning about initializer list order
flag = -Wall $(no_warn)

# link (dynamic link to MKL)
goal:main.o
	g++ $(flag) -L$(MKLROOT)/lib/intel64 -Wl,--no-as-needed -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lpthread -lm -ldl -fopenmp -o main.x main.o

# compile
main.o:main.cpp
	g++ $(flag) -m64 -I$(MKLROOT)/include -std=c++17 -fopenmp -c main.cpp

clean:
	rm -f *.o *.x
